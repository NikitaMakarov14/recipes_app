# Приложение для рецептов

Это мобильное приложение на базе Flutter для просмотра, поиска и фильтрации рецептов. Приложение использует современную архитектуру Flutter с BLoC для управления состоянием, Hive для локального кэширования и Provider для внедрения зависимостей. Поддерживает светлую и темную темы, доступ к данным в оффлайн-режиме и пагинацию для эффективной загрузки данных.

## Реализованные функции

- **Экран списка рецептов**: Отображает список рецептов, полученных через API, с поддержкой бесконечной прокрутки (пагинация).
- **Поиск**: Поиск рецептов по названию или ингредиентам.
- **Фильтры**: Фильтрация рецептов по наличию изображений и максимальному времени приготовления.
- **Экран детальной информации о рецепте**: Показывает подробную информацию о выбранном рецепте, включая название, время приготовления, описание, ингредиенты, шаги и пищевую ценность.
- **Оффлайн-поддержка**: Использует Hive для кэширования рецептов с валидностью кэша 1 час для первой страницы.
- **Поддержка тем**: Светлая и темная темы с динамическим переключением через Provider, с сохранением настроек через `shared_preferences`.
- **Мониторинг состояния интернета**: Отслеживает изменения подключения к интернету и корректно обрабатывает оффлайн-сценарии с помощью `internet_connection_checker_plus`.
- **Навигация**: Использует `go_router` для переходов между экраном списка рецептов и экраном детальной информации.
- **Обработка ошибок**: Отображает понятные сообщения об ошибках при проблемах с сетью или загрузкой данных.

## Установка и запуск приложения

### Требования
- **Flutter SDK**: Версия 3.22.0 или выше.
- **Dart**: Версия 3.4.0 или выше.
- **IDE**: Android Studio, VS Code или любая другая IDE, совместимая с Flutter.
- **Эмулятор/Устройство**: Эмулятор Android/iOS или физическое устройство для тестирования.
- **Конфигурация Android**: Убедитесь, что приложению предоставлено разрешение на доступ к интернету, как указано в `AndroidManifest.xml`.

### Зависимости
Приложение использует следующие пакеты (указаны в `pubspec.yaml`):
- `flutter_bloc`: Для управления состоянием.
- `provider`: Для внедрения зависимостей (тема и состояние интернета).
- `hive_flutter`: Для локального хранения данных и оффлайн-поддержки.
- `cached_network_image`: Для эффективной загрузки и кэширования изображений.
- `go_router`: Для навигации.
- `dio`: Для HTTP-запросов к API.
- `freezed_annotation`: Для неизменяемых моделей данных.
- `hive`: Для локальной базы данных.
- `internet_connection_checker_plus`: Для мониторинга состояния интернета.
- `shared_preferences`: Для сохранения настроек темы.
- Прочие стандартные зависимости Flutter (например, `flutter/material.dart`).

Для установки зависимостей выполните:
```bash
flutter pub get
```

### Запуск приложения
1. Клонируйте репозиторий:
   ```bash
   git clone <https://github.com/NikitaMakarov14/recipes_app>
   cd recipe_app
   ```
2. Установите зависимости:
   ```bash
   flutter pub get
   ```
3. Убедитесь, что Hive инициализирован, сгенерировав адаптеры типов для моделей Hive:
   ```bash
   flutter packages pub run build_runner build
   ```
4. Запустите приложение:
   ```bash
   flutter run
   ```
5. Для сборки релизной версии:
   ```bash
   flutter build apk  # Для Android
   flutter build ios  # Для iOS
   ```

**Конфигурация Android**:
- Файл `AndroidManifest.xml` включает разрешение на доступ к интернету (`android.permission.INTERNET`), необходимое для API-запросов.
- Кроме того необходимы дополнительные настройки файла для разрешения deep-linking.
- Минимальный SDK установлен на 21, целевой SDK — 34.

## Подробности API
Приложение взаимодействует с внешним API, размещенным на `https://madeindream.com`. Сервис API реализован с использованием Dio с перехватчиками для логирования. Основные особенности и предположения об API:

- **Эндпоинты**:
  - `/index.php?route=api/app/getRecipes&offset=<offset>&limit=<limit>`: Получает список рецептов с поддержкой пагинации (приложение имитирует это).
  - `/index.php?route=api/app/getRecipe&id=<id>`: Получает отдельный рецепт по его ID (приложение имитирует это).
- **Структура ответа**: Ожидается JSON-ответ, маппящийся на сущности `Recipe` через модели Freezed, включая поля `id`, `title`, `image`, `prepTime`, `text`, `ingredientsOne`, `ingredientsTwo`, `steps`, `energy`, `dateAdded` и `link`.
- **Обработка ошибок**: Приложение обрабатывает ошибки API, отображая кэшированные данные (через Hive) или сообщения об ошибках, если кэшированные данные отсутствуют.
- **Оффлайн-поддержка**: При недоступности API загружаются кэшированные рецепты из Hive. Кэш сохраняется только для первой страницы и действителен в течение 1 часа.
- **Таймауты**: Таймаут подключения установлен на 10 секунд, таймаут получения данных — 15 секунд.

**Примечание**: Убедитесь, что API поддерживает указанные маршруты и возвращает данные в ожидаемом формате JSON. API использует текстовый тип ответа и требует декодирования JSON.

## Ограничения
- **Зависимость от API**: Приложение зависит от внешнего API. Если API недоступен и кэшированные данные отсутствуют, приложение покажет ошибку.
- **Ограничения фильтрации**:
  - Фильтр по времени предполагает, что время приготовления указано в формате с извлекаемыми числовыми значениями (например, "30 минут").
  - Фильтрация выполняется на стороне клиента, что может повлиять на производительность при больших наборах данных.
- **Загрузка изображений**: Используется `cached_network_image`, что может привести к сбоям, если URL изображений недействителен или сервер работает медленно.
- **Отсутствие расширенного поиска**: Поиск ограничен названием и ингредиентами; нет поддержки сложных запросов (например, по категориям или тегам).
- **Отсутствие локализации**: Приложение использует фиксированные строки на русском языке для элементов интерфейса, что ограничивает поддержку других языков.
- **Область кэширования**: Кэшируется только первая страница рецептов; для последующих страниц требуется доступ к интернету.
- **Сохранение темы**: Настройки темы сохраняются локально с помощью `shared_preferences`, но синхронизация между устройствами на основе аккаунта не реализована.
